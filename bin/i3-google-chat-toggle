#!/bin/bash

# Launch Google Chat if not already running
if ! xdotool search --classname "crx_mdpkiolbdkhdjpekfbkbmhigcaggjagi" > /dev/null; then
    google-chrome-stable --profile-directory="Profile 1" --app-id="mdpkiolbdkhdjpekfbkbmhigcaggjagi" &
    sleep 1 # Give it time to create the window and move it to the scratchpad

    # Get workspace info with monitor geometry
    WORKSPACE_INFO=$(i3-msg -t get_workspaces | jq -r '.[] | select(.focused==true) | "\(.output) \(.rect.x) \(.rect.width)"')

    read FOCUSED_OUTPUT MONITOR_X MONITOR_WIDTH <<< "$WORKSPACE_INFO"

    # Calculate position
    WINDOW_X=$((MONITOR_X + MONITOR_WIDTH / 2))

    # Show and position
    i3-msg '[instance="crx_mdpkiolbdkhdjpekfbkbmhigcaggjag"] scratchpad show, move window to output '$FOCUSED_OUTPUT', move position '$WINDOW_X'px 600px'
else
    # Just toggle - i3 remembers last position
    i3-msg '[instance="crx_mdpkiolbdkhdjpekfbkbmhigcaggjag"] scratchpad show'
fi