#!/bin/bash
# Sidepanel launcher for jgmenu

CONFIG_DIR="${XDG_CONFIG_HOME:-$HOME/.config}/jgmenu"
UPTIME=$(awk '{
    d = int($1 / 86400)
    h = int($1 % 86400 / 3600)
    m = int($1 % 3600 / 60)
    if (d > 0) printf "%dd %dh %dm", d, h, m
    else if (h > 0) printf "%dh %dm", h, m
    else printf "%dm", m
}' /proc/uptime)
PACMAN_CACHE=$(du -sh /var/cache/pacman/pkg 2>/dev/null | awk '{print $1}')

{
    echo "^sep(System Info)"
    echo " Uptime: $UPTIME,,,,#2e3440 0,#d8dee9 100"
    echo " Kernel: $(uname -r),,,,#2e3440 0,#d8dee9 100"
    echo "^sep()"
    echo " Pacman Cache: $PACMAN_CACHE,,,,#2e3440 0,#d8dee9 100"
    cat "$CONFIG_DIR/panel.csv"
} | jgmenu --simple --config-file="$CONFIG_DIR/panel.conf" --csv-file=/dev/stdin

